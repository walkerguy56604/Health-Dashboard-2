const fs = require('fs');
const path = require('path');

// Path to latest.json
const filePath = path.join(__dirname, '..', 'latest.json');

// Sample new reading (replace with actual data source if needed)
const newReading = {
  date: new Date().toISOString(),
  systolic: 130,
  diastolic: 88,
  pulse: 72,
  IHB: "No",
  arm: "Right",
  position: "Sitting",
  symptoms: "None",
  notes: "Auto-updated"
};

// Load existing data
let readings = [];
if (fs.existsSync(filePath)) {
  const data = fs.readFileSync(filePath, 'utf8');
  try {
    readings = JSON.parse(data);
  } catch (err) {
    console.error("Error parsing latest.json:", err);
  }
}

// Append new reading
readings.push(newReading);

// Save back to latest.json
fs.writeFileSync(filePath, JSON.stringify(readings, null, 2));
console.log("Added new reading:", newReading.date);
