<script>
// ==== CONFIGURE THESE ==== 
const username = "walkerguy56604"; 
const repo = "Health-Dashboard-2"; 
// =========================

const today = new Date();
const year = today.getFullYear();
const month = String(today.getMonth() + 1).padStart(2, '0');
const day = String(today.getDate()).padStart(2, '0');
const todayPath = `logs/${year}-${month}-${day}.md`;

const dateLabel = document.createElement("h2");
dateLabel.textContent = `Daily Log for ${year}-${month}-${day}`;
document.body.appendChild(dateLabel);

// Function to fetch a log file
function fetchLog(path) {
  return fetch(`https://api.github.com/repos/${username}/${repo}/contents/${path}`)
    .then(res => {
      if (!res.ok) throw new Error("Log not found");
      return res.json();
    })
    .then(data => atob(data.content));
}

// Try today's log first
fetchLog(todayPath)
  .then(content => {
    const logContainer = document.createElement("pre");
    logContainer.textContent = content;
    document.body.appendChild(logContainer);
  })
  .catch(() => {
    // If today’s log isn’t found, show most recent log
    fetch(`https://api.github.com/repos/${username}/${repo}/contents/logs?per_page=1&sort=desc`)
      .then(res => res.json())
      .then(data => {
        if (data.length > 0) {
          return fetchLog(`logs/${data[0].name}`);
        } else {
          throw new Error("No logs found at all");
        }
      })
      .then(content => {
        const logContainer = document.createElement("pre");
        logContainer.textContent = content;
        document.body.appendChild(logContainer);
      })
      .catch(() => {
        const placeholder = document.createElement("p");
        placeholder.textContent = "No log available yet. Come back later!";
        placeholder.style.fontStyle = "italic";
        placeholder.style.color = "gray";
        document.body.appendChild(placeholder);
      });
  });
</script>
